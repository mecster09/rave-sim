### Rave Web Services Mock API - Sample Requests
### Use the REST Client extension in VS Code or similar tools

@baseUrl = http://localhost:3000
@authHeader = Basic dGVzdDp0ZXN0MTIz

### Health Check
GET {{baseUrl}}/health

### Get API Info
GET {{baseUrl}}/

### Get RWS Version (requires auth)
GET {{baseUrl}}/RaveWebServices/version
Authorization: {{authHeader}}

### Cache Flush
GET {{baseUrl}}/RaveWebServices/WebService.aspx?CacheFlush
Authorization: {{authHeader}}

### Clinical Audit Records (ODM)
GET {{baseUrl}}/RaveWebServices/datasets/ClinicalAuditRecords.odm?studyoid=STUDY001
Authorization: {{authHeader}}
Accept: application/xml

### Clinical Audit Records with Pagination
GET {{baseUrl}}/RaveWebServices/datasets/ClinicalAuditRecords.odm?studyoid=STUDY001&per_page=100&startid=1000
Authorization: {{authHeader}}
Accept: application/xml

### Subjects Calendar
GET {{baseUrl}}/RaveWebServices/datasets/SubjectsCalendar.odm?studyoid=STUDY001
Authorization: {{authHeader}}
Accept: application/xml

### Clinical Datasets Metadata
GET {{baseUrl}}/RaveWebServices/datasets/ClinicalDatasets.odm?studyoid=STUDY001
Authorization: {{authHeader}}
Accept: application/xml

### Users CSV Dataset
GET {{baseUrl}}/RaveWebServices/datasets/Users.csv
Authorization: {{authHeader}}
Accept: text/csv

### Sites CSV Dataset
GET {{baseUrl}}/RaveWebServices/datasets/Sites.csv
Authorization: {{authHeader}}
Accept: text/csv

### Signatures CSV Dataset
GET {{baseUrl}}/RaveWebServices/datasets/Signatures.csv
Authorization: {{authHeader}}
Accept: text/csv

### Version Folders CSV Dataset
GET {{baseUrl}}/RaveWebServices/datasets/VersionFolders.csv
Authorization: {{authHeader}}
Accept: text/csv

### Import Clinical Data (ODM XML)
POST {{baseUrl}}/RaveWebServices
Authorization: {{authHeader}}
Content-Type: text/xml; charset=utf-8

<?xml version="1.0" encoding="utf-8"?>
<ODM xmlns="http://www.cdisc.org/ns/odm/v1.3"
     FileType="Transactional"
     FileOID="import-001"
     CreationDateTime="2024-01-01T00:00:00"
     ODMVersion="1.3">
  <ClinicalData StudyOID="STUDY001" MetaDataVersionOID="1">
    <SubjectData SubjectKey="001" TransactionType="Insert">
      <StudyEventData StudyEventOID="SCREENING">
        <FormData FormOID="DM">
          <ItemGroupData ItemGroupOID="DM_IG">
            <ItemData ItemOID="SUBJID" Value="001"/>
            <ItemData ItemOID="AGE" Value="45"/>
          </ItemGroupData>
        </FormData>
      </StudyEventData>
    </SubjectData>
  </ClinicalData>
</ODM>

### MAuth Header Example (stubbed)
GET {{baseUrl}}/RaveWebServices/version
X-MWS-Authentication: mock-mauth-signature

### Test Unauthorized Access
GET {{baseUrl}}/RaveWebServices/version
# No auth header - should return 401

### Test Missing Required Parameter
GET {{baseUrl}}/RaveWebServices/datasets/ClinicalAuditRecords.odm
Authorization: {{authHeader}}
# Missing studyoid - should return 400

### Test Invalid ODM XML
POST {{baseUrl}}/RaveWebServices
Authorization: {{authHeader}}
Content-Type: text/xml

<Invalid>This is not valid ODM XML</Invalid>

